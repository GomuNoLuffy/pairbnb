<!DOCTYPE html>
<html>
  <head>
    <title>Pairbnb</title>
    <%= csrf_meta_tags %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
 

      <nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
        <a class="navbar-brand" href="/">Pairbnb</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

   <%= form_tag(listings_path, method: :get, remote: true, class: "navbar-form navbar-left") do %>
  <%= text_field_tag :term, params[:term], placeholder: "Enter country", list: "countries", class: "form-control" %>
  <datalist id="countries">
    <% Listing.all.distinct.pluck(:country).sort.each do |country| %>
    <option value= <%= country %>>
  <% end %>

  </datalist>
  <%= submit_tag 'Search', name: nil, class: "btn btn-default" %>
<% end %>


<% if !signed_in? %>
       <ul class="nav navbar-nav navbar-right">

<button type="button" class="btn btn-link btn-lg pull-left" data-toggle="modal" data-target="#myModal1">Sign Up</button>

  <!-- Modal -->
  <div class="modal fade" id="myModal1" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Sign Up</h4>
        </div>
        <div class="modal-body">
        <div id="clearance" class="sign-up">
          <%= form_for :user, url: "/users", remote: true do |form| %>
            <%= render partial: '/users/form', object: form %>

          <div class="submit-field">
            <%= form.submit class: "btn btn-default btn-primary" %>
          </div>
      <% end %>
      </div>
     </div> <!-- /.modal-body -->
    </div><!-- /.modal-content -->
   </div> <!-- /.modal-dialog -->

  </div> <!-- /.modal-fade -->



  <!-- Trigger the modal with a button -->
  <button type="button" class="btn btn-link btn-lg pull-right" data-toggle="modal" data-target="#myModal">Log In</button>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Log In</h4>
        </div> <!-- /.modal-header -->
        <div class="modal-body">
          <%= form_for :session, url: session_path do |form| %>
            <div class="form-group has-feedback" style="margin: 2em; width: 300px;">
              <div class="text-field">
              <%= form.label :email %>
              <%= form.text_field :email, type: 'email', placeholder: "Email address", class: "form-control" %>
              <i class="glyphicon glyphicon-envelope form-control-feedback"></i>
              </div>
            </div>

            <div class="form-group has-feedback" style="margin: 2em; width: 300px;">
              <div class="password-field">
              <%= form.label :password %>
              <%= form.password_field :password, placeholder: "Password", class: "form-control"  %>
              <i class=" glyphicon glyphicon-lock form-control-feedback"></i>
              </div>
            </div>

         <div class="checkbox">
              <label><input type="checkbox" value="" checked>Remember me</label>
          </div>

    <%= link_to t(".forgot_password"), new_password_path, class: "pull-right" %>

  <div class="submit-field">
    <%= form.submit class: "btn btn-default btn-primary btn-lg" %>
  </div> 
<% end %>

<hr />
  <div class="other-links">

  <%= link_to "Sign in with Facebook", "/auth/facebook", class: "btn btn-default btn-lg"%>
  </div>       

        </div> <!-- /.modal-body -->
        <div class="modal-footer">
            <p> Don't have an account? <button type="button" class="btn btn-default pull-lg-left" data-dismiss="modal" data-toggle="modal" data-target="#myModal1"><i class="fa fa-unlock-alt"></i>Sign Up</button></p>
        </div> <!-- /.modal-footer -->
      </div> <!-- /.modal-content -->
      
    </div> <!-- /.modal-dialog -->
  </div> <!-- /.modal-fade -->
     <% end %>
  <% if signed_in? %>
<ul class="nav navbar-nav navbar-right">

        <li class="dropdown">
         <% if current_user %>
          <a href="#" class="dropdown-toggle pull-left" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Signed in as: <%= current_user.email %> <span class="caret"></span></a>
          <% end %>
          <ul class="dropdown-menu">
            <li><a class="btn btn-block" href="/users/<%= current_user.id %>">View Profile</a></li>
            <li><%= link_to 'Your Listings', user_listings_path(current_user) %></li>
            <li role="separator" class="divider"></li>
            <li><% if current_user %>
            <div id="logout">
              <%= link_to 'Sign out', sign_out_path, method: :delete, class: "btn btn-link btn-block" %>
              </div> 
              <% end %></li>
          </ul>
        </li>
</ul>
<% end %>







</ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

 
<!--     <% if signed_in? %>
      Signed in as: <%= current_user.email %>
      <%= button_to 'Sign out', sign_out_path, method: :delete %>
    <% else %>
      <%= link_to 'Sign in', sign_in_path %>
    <% end %> -->

    <div class="container">
      
        <%= flash_messages %>
    </div>

    <%= yield %>
    </div>
  </body>
</html>

